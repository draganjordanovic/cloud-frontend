<mat-card class="album-card">
  <h2>Create Album</h2>

  <form [formGroup]="albumForm" (ngSubmit)="submit()">
    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Album Title</mat-label>
      <input matInput formControlName="albumTitle" required>
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description"></textarea>
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Release Year</mat-label>
      <input matInput type="number" formControlName="releaseYear" required>
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Genres (comma-separated)</mat-label>
      <input matInput formControlName="genres">
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Artists</mat-label>
      <mat-select formControlName="artistIds" multiple required>
        <mat-option *ngFor="let artist of artists" [value]="artist.id">{{ artist.name }}</mat-option>
      </mat-select>
    </mat-form-field>

    <h3>Songs</h3>
    <div formArrayName="songs" class="songs-section">
      <div *ngFor="let song of songs.controls; let i = index" [formGroupName]="i" class="song-card">
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Song Title</mat-label>
          <input matInput formControlName="title" required>
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Genres (comma-separated)</mat-label>
          <input matInput formControlName="genres">
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description"></textarea>
        </mat-form-field>

        <input type="file" (change)="onFileSelected($event, i)" accept="audio/*" required>

        <button mat-stroked-button color="warn" type="button" (click)="removeSong(i)" *ngIf="songs.length > 1">
          Remove Song
        </button>
      </div>

      <button mat-raised-button color="primary" type="button" (click)="addSong()">+ Add Another Song</button>
    </div>

    <button mat-raised-button color="accent" class="submit-btn" type="submit" [disabled]="isSubmitting">
      {{ isSubmitting ? 'Creating...' : 'Create Album' }}
    </button>
  </form>
</mat-card>
